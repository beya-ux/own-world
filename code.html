<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Enter PIN Code</title>
  <style>
    :root{
      --bg1: #ffe7f0;
      --bg2: #fff6e6;
      --card: #ffffff;
      --accent: #e6377d;
      --accent2: #ff7fbf;
      --muted: #6b6b6b;
    }

    html,body{
      height:100%;
      margin:0;
      font-family: Inter, Arial, sans-serif;
      background: radial-gradient(circle at 10% 10%, #fff8fb 0%, #ffeef8 15%, #fff6e6 60%), linear-gradient(120deg, var(--bg1), var(--bg2));
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* soft floating confetti dots */
    .confetti {
      position:fixed;
      inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .confetti span{
      position:absolute;
      width:10px;height:10px;border-radius:50%;
      opacity:0.9;
      transform:translateY(-120%);
      animation:fall linear infinite;
    }
    @keyframes fall {
      to { transform: translateY(120vh) rotate(360deg); }
    }

    .pin-container{
      background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.92));
      backdrop-filter: blur(6px);
      border-radius:20px;
      box-shadow: 0 10px 30px rgba(166,78,124,0.12);
      padding:34px;
      width:340px;
      text-align:center;
      border: 1px solid rgba(255,255,255,0.6);
    }

    .logo {
      font-size: 36px;
      line-height: 1;
      margin-bottom: 12px;
      transform: translateY(-2px);
    }

    h2{
      margin:0;
      font-size:20px;
      color:var(--accent);
      letter-spacing:0.4px;
    }
    h6{
      margin:8px 0 20px 0;
      color:var(--muted);
      font-weight:600;
      font-size:13px;
    }

    .pin-inputs{
      display:flex;
      justify-content:center;
      gap:12px;
      margin-bottom:18px;
    }

    .pin-inputs input{
      -webkit-appearance:none;
      appearance:none;
      width:58px;
      height:58px;
      border-radius:14px;
      border:2px solid rgba(200,200,200,0.9);
      background: linear-gradient(180deg,#fff,#fff7);
      text-align:center;
      font-size:26px;
      font-weight:700;
      outline:none;
      transition: all .18s ease;
      box-shadow: 0 4px 10px rgba(216,105,147,0.06), inset 0 -4px 8px rgba(0,0,0,0.02);
    }
    .pin-inputs input:focus{
      transform: translateY(-3px);
      border-color: var(--accent2);
      box-shadow: 0 8px 20px rgba(230,99,135,0.12), 0 0 6px rgba(255,127,191,0.12);
    }

    .actions{
      display:flex;
      gap:10px;
      justify-content:center;
      align-items:center;
    }

    button{
      padding:12px 22px;
      border-radius:12px;
      border:none;
      cursor:pointer;
      font-weight:700;
      background: linear-gradient(90deg, #ff8dbd, #e6377d);
      color:white;
      box-shadow: 0 8px 18px rgba(230,99,135,0.18);
      transition: transform .12s ease;
    }
    button:active{ transform: translateY(1px); }

    .message{
      margin-top:14px;
      font-weight:700;
      font-size:14px;
      min-height:20px;
      color:var(--accent);
    }
    .muted{
      color:var(--muted);
      font-weight:600;
      font-size:13px;
    }

    .success{ color: #2f8f4a; }
    .error{ color: #e6377d; }

    /* cute cake icon bounce */
    .cake{
      display:inline-block;
      font-size:28px;
      transform-origin:center;
      animation: bounce 2s infinite;
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
    }

    /* small footer note */
    .note{ margin-top:10px; font-size:12px; color:#9a6a7f; }

    /* responsive */
    @media (max-width:380px){
      .pin-container{ width:92%; padding:20px; }
      .pin-inputs input{ width:48px; height:48px; }
    }
  </style>
</head>
<body>
  <!-- confetti dots (pure CSS motion) - generated by JS below -->
  <div class="confetti" id="confetti"></div>

  <div class="pin-container" aria-live="polite">
    <div class="logo"><span style="font-weight:800;color:#ff6393">SweetGate</span></div>
    <h2>Enter PIN</h2>
    <h6>Hint: Our cake days mixed into one sweet code üç∞</h6>

    <div class="pin-inputs" aria-label="PIN inputs">
      <input inputmode="numeric" pattern="[0-9]*" type="password" maxlength="1" id="d1" autocomplete="off" aria-label="digit 1">
      <input inputmode="numeric" pattern="[0-9]*" type="password" maxlength="1" id="d2" autocomplete="off" aria-label="digit 2">
      <input inputmode="numeric" pattern="[0-9]*" type="password" maxlength="1" id="d3" autocomplete="off" aria-label="digit 3">
      <input inputmode="numeric" pattern="[0-9]*" type="password" maxlength="1" id="d4" autocomplete="off" aria-label="digit 4">
    </div>

    <div class="actions">
      <button id="submitBtn" aria-label="Submit PIN">Submit</button>
    </div>

    <div class="message" id="message"></div>
    <div class="note">Tip: press <strong>Enter ‚Üµ</strong> after filling the 4 digits.</div>
  </div>

  <script>
    // === Configuration ===
    const correctPin = "2029"; 
    const redirectTo = "front.html";
    const maxAttempts = 3;
    const lockoutSeconds = 8;

    // === Elements ===
    const inputs = Array.from(document.querySelectorAll('.pin-inputs input'));
    const submitBtn = document.getElementById('submitBtn');
    const messageEl = document.getElementById('message');

    // Save access marker to localStorage after correct PIN
    function grantAccessAndRedirect() {
      localStorage.setItem('site_access_granted', '1'); // small gatekeeper
      showMessage("Yehey!! Goob Job! üéâ ", "success");
      // short delay for celebration
      setTimeout(() => {
        // tiny confetti burst
        confettiBurst(20);
        setTimeout(() => window.location.href = redirectTo, 900);
      }, 700);
    }

    // Show message helper
    function showMessage(text, type='') {
      messageEl.textContent = text;
      messageEl.className = 'message ' + (type || '');
    }

    // Read entered pin
    function getEnteredPin() {
      return inputs.map(i => i.value.trim()).join('');
    }

    // Clear inputs helper
    function clearInputs() {
      inputs.forEach(i => i.value = '');
      inputs[0].focus();
    }

    // Attempt tracking
    let attempts = 0;
    if (localStorage.getItem('pin_attempts')) {
      attempts = parseInt(localStorage.getItem('pin_attempts'), 10) || 0;
    }

    // Submit handling
    function checkPin() {
      const pin = getEnteredPin();
      if (pin.length < 4) {
        showMessage("Please enter all 4 digits.", "error");
        return;
      }
      if (pin === correctPin) {
        grantAccessAndRedirect();
      } else {
        attempts++;
        localStorage.setItem('pin_attempts', String(attempts));
        if (attempts >= maxAttempts) {
          lockInputs(lockoutSeconds);
        } else {
          showMessage("Try Again Love,The code is solved with your day + my day", "error");
          clearInputs();
        }
      }
    }

    // Lockout UI
    function lockInputs(seconds) {
      inputs.forEach(i => i.disabled = true);
      submitBtn.disabled = true;
      let remaining = seconds;
      showMessage(`Too many tries ‚Äî wait ${remaining}s`, "error");
      const t = setInterval(() => {
        remaining--;
        if (remaining > 0) {
          showMessage(`Too many tries ‚Äî wait ${remaining}s`, "error");
        } else {
          clearInterval(t);
          attempts = 0;
          localStorage.setItem('pin_attempts', '0');
          inputs.forEach(i => i.disabled = false);
          submitBtn.disabled = false;
          clearInputs();
          showMessage("You may try again üôÇ", "muted");
        }
      }, 1000);
    }

    // Auto-advance and input handlers
    inputs.forEach((input, idx) => {
      input.addEventListener('input', (e) => {
        // allow only digits
        input.value = input.value.replace(/[^0-9]/g,'').slice(0,1);
        if (input.value && idx < inputs.length - 1) {
          inputs[idx + 1].focus();
        }
      });

      input.addEventListener('keydown', (e) => {
        if (e.key === 'Backspace' && !input.value && idx > 0) {
          inputs[idx - 1].focus();
        }
        if (e.key === 'Enter') {
          // if Enter pressed in last field or any field, try submit
          if (getEnteredPin().length === 4) checkPin();
        }
      });

      // Prevent paste of more than 1 char into a field, but allow pasting full pin into first field
      input.addEventListener('paste', (e) => {
        e.preventDefault();
        const text = (e.clipboardData || window.clipboardData).getData('text').trim();
        if (/^\d{4}$/.test(text)) {
          // fill all
          inputs.forEach((el, i) => el.value = text[i]);
          inputs[inputs.length - 1].focus();
        } else if (/^\d{1,4}$/.test(text)) {
          // paste sequentially starting here
          for (let i = 0; i < text.length && idx + i < inputs.length; i++) {
            inputs[idx + i].value = text[i];
          }
          const next = Math.min(inputs.length - 1, idx + text.length);
          inputs[next].focus();
        }
      });
    });

    // Submit button
    submitBtn.addEventListener('click', checkPin);

    // Start focus
    inputs[0].focus();

    // Simple confetti utility (creates colored dots)
    const confettiContainer = document.getElementById('confetti');
    function createConfettiDot(leftPercent, size, delay, color){
      const el = document.createElement('span');
      el.style.left = leftPercent + '%';
      el.style.width = el.style.height = size + 'px';
      el.style.background = color;
      el.style.top = (-Math.random()*20 - 10) + 'vh';
      el.style.animationDuration = (Math.random()*3 + 3) + 's';
      el.style.animationDelay = delay + 's';
      confettiContainer.appendChild(el);
      // remove after animation
      setTimeout(()=> el.remove(), 8000);
    }
    function confettiBurst(count=15){
      const palette = ['#ff9cc8','#ffd37e','#b6f2c6','#ffc0e6','#c2e7ff'];
      for(let i=0;i<count;i++){
        createConfettiDot(Math.random()*100, Math.random()*10+6, Math.random()*0.3, palette[Math.floor(Math.random()*palette.length)]);
      }
    }
    // constant soft confetti in background (decorative)
    (function backgroundConfetti(){
      const colors = ['#ffd7ea','#ffe9c7','#cdeedc','#fdd6f0','#dff2ff'];
      for (let i=0;i<12;i++){
        const left = Math.random()*100;
        const size = Math.random()*12 + 6;
        createConfettiDot(left, size, Math.random()*-4, colors[i%colors.length]);
      }
    })();


  </script>
</body>
</html>
